<div class="loading" *ngIf="isLoading">
    <mat-spinner></mat-spinner>
</div>

<div class="event" *ngIf="!isLoading">
    <div class="event__details">
        <mat-card>
            <img class="event__details-logo" src="{{surfEvent.logo}}" alt="event logo">
            <h1>{{surfEvent.name}}</h1>
            <dl>
                <dt>Description</dt>
                <dd>{{surfEvent.description}}</dd>
                <dt>Start</dt>
                <dd>{{surfEvent.startDateTime | date:'d MMMM YYYY HH:mm'}}</dd>
                <dt>End</dt>
                <dd>{{surfEvent.endDateTime | date:'d MMMM YYYY HH:mm'}}</dd>
                <dt>Location</dt>
                <dd>{{surfEvent.location}}</dd>
                <dt>Hashtag</dt>
                <dd>
                    <a href="https://www.instagram.com/explore/tags/{{surfEvent.hashTag}}"
                       target="_blank" rel="noopener noreferrer">
                        #{{surfEvent.hashTag}}
                    </a>
                </dd>
            </dl>
        </mat-card>
    </div>
    <div class="event__images">
        <div class="event__images__slideshow">
            <img class="event__images__slideshow-image" src="{{surfEvent.mainPicture}}" alt="event images"/>
        </div>
    </div>
    <div class="event__divisions">
        <div class="event__divisions__selection">
            <h2>Competitions</h2>
            <mat-chip-list aria-label="Divisions">
                <mat-chip
                    *ngFor="let division of surfEvent.divisions"
                    [color]="division | divisionColor"
                    routerLink="/event/{{surfEvent.name | slugify}}-{{surfEvent.id}}/competition/{{ division }}"
                    selected>
                    {{division}}
                </mat-chip>
            </mat-chip-list>
        </div>
        <div class="event__divisions__riders">
            <h2>Riders</h2>
            <!--<div *ngFor="let division of surfEvent.divisions">
                <rs-rider-card *ngFor="let rider of division.riders | slice:0:1" [rider]="rider"></rs-rider-card>
            </div>
            <div *ngFor="let division of surfEvent.competitions" class="event__divisions__riders">
                <rs-carousel [index]="0" [auto]="false">
                    <ng-container *ngFor="let rider of division.riders">
                        <rs-rider-card [rider]="rider" *rs-carousel-item></rs-rider-card>
                    </ng-container>
                </rs-carousel>
            </div>-->
            <ng-container *ngIf="enrolledRiders$ | async as enrolledRiders">
                <div *ngFor="let rider of enrolledRiders"
                     title="{{rider.firstName}} {{rider.lastName}}"
                     class="event__divisions__riders__image"
                     [style.background-image]="'url(' + rider.profilePicture + ')'">&nbsp;
                </div>
            </ng-container>
        </div>
    </div>
</div>

<div *ngIf="!isLoading" class="event__map">
    <google-map
        width="100%"
        height="500px"
        [center]="{lat: surfEvent.locationLat, lng: surfEvent.locationLong}"
        [zoom]="mapZoom"
        [options]="mapOptions">
        <map-marker
            [position]="{lat: surfEvent.locationLat, lng: surfEvent.locationLong}"
            [title]="surfEvent.name">
        </map-marker>
    </google-map>
</div>
